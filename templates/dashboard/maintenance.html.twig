{% extends 'base.html.twig' %}

{% block title %}Maintenance{% endblock %}

{% block body %}
    <!-- En-tête page -->
    <div class="card mb-3">
        <div class="card-header">
            <div class="row flex-between-end">
                <div class="col-auto align-self-center">
                    <h5 class="mb-0">Maintenance</h5>
                    <p class="mb-0 fs-11 text-muted">Gestion et suivi des interventions de maintenance</p>
                </div>
                <div class="col-auto ms-auto">
                    <div class="btn-group" role="group">
                        <button class="btn btn-primary btn-sm" type="button">
                            <span class="fas fa-plus me-1"></span>Nouvelle Demande
                        </button>
                        <button class="btn btn-outline-primary btn-sm" type="button">
                            <span class="fas fa-calendar-alt me-1"></span>Planning
                        </button>
                        <button class="btn btn-outline-secondary btn-sm" type="button">
                            <span class="fas fa-filter me-1"></span>Filtrer
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sélecteur de période et statut -->
    <div class="row g-3 mb-3">
        <div class="col-auto">
            <div class="btn-group" role="group" aria-label="Statut">
                <input type="radio" class="btn-check" name="statut" id="all" checked>
                <label class="btn btn-outline-primary btn-sm" for="all">Toutes</label>

                <input type="radio" class="btn-check" name="statut" id="urgent">
                <label class="btn btn-outline-danger btn-sm" for="urgent">Urgentes</label>

                <input type="radio" class="btn-check" name="statut" id="planifiees">
                <label class="btn btn-outline-info btn-sm" for="planifiees">Planifiées</label>

                <input type="radio" class="btn-check" name="statut" id="terminees">
                <label class="btn btn-outline-success btn-sm" for="terminees">Terminées</label>
            </div>
        </div>
        <div class="col-auto ms-auto">
            <div class="input-group input-group-sm">
                <input class="form-control" type="month" value="2025-09" />
                <button class="btn btn-outline-secondary" type="button">
                    <span class="fas fa-calendar-alt"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Métriques maintenance principales -->
    <div class="row g-3 mb-3">
        <div class="col-sm-6 col-lg-3">
            <div class="card overflow-hidden" style="min-height: 10rem">
                <div class="bg-holder bg-card" style="background-image:url(assets/img/icons/spot-illustrations/corner-1.png);"></div>
                <div class="card-body position-relative">
                    <h6 class="text-muted">Demandes Actives</h6>
                    <div class="display-4 fs-4 mb-2 fw-normal font-sans-serif text-warning">12</div>
                    <div class="d-flex align-items-center">
                        <span class="badge badge-subtle-danger rounded-pill fs-11">3 urgentes</span>
                        <span class="fs-11 ms-1 text-muted">à traiter</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card overflow-hidden" style="min-height: 10rem">
                <div class="bg-holder bg-card" style="background-image:url(assets/img/icons/spot-illustrations/corner-2.png);"></div>
                <div class="card-body position-relative">
                    <h6 class="text-muted">Coût Mensuel</h6>
                    <div class="display-4 fs-4 mb-2 fw-normal font-sans-serif text-primary">€2,340</div>
                    <div class="d-flex align-items-center">
                        <span class="badge badge-subtle-warning rounded-pill fs-11">+15.2%</span>
                        <span class="fs-11 ms-1 text-muted">vs mois dernier</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card overflow-hidden" style="min-height: 10rem">
                <div class="bg-holder bg-card" style="background-image:url(assets/img/icons/spot-illustrations/corner-3.png);"></div>
                <div class="card-body position-relative">
                    <h6 class="text-muted">Temps Résolution Moy.</h6>
                    <div class="display-4 fs-4 mb-2 fw-normal font-sans-serif text-info">3.2 jours</div>
                    <div class="d-flex align-items-center">
                        <span class="badge badge-subtle-success rounded-pill fs-11">-0.8j</span>
                        <span class="fs-11 ms-1 text-muted">amélioration</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card overflow-hidden" style="min-height: 10rem">
                <div class="bg-holder bg-card" style="background-image:url(assets/img/icons/spot-illustrations/corner-4.png);"></div>
                <div class="card-body position-relative">
                    <h6 class="text-muted">Interventions Terminées</h6>
                    <div class="display-4 fs-4 mb-2 fw-normal font-sans-serif text-success">28</div>
                    <div class="d-flex align-items-center">
                        <span class="fs-11 text-muted">ce mois-ci</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Graphique évolution et répartition types -->
    <div class="row g-3 mb-3">
        <div class="col-lg-8">
            <div class="card h-100">
                <div class="card-header">
                    <div class="row flex-between-end">
                        <div class="col-auto">
                            <h6 class="mb-0">Évolution des Interventions & Coûts</h6>
                        </div>
                        <div class="col-auto">
                            <div class="btn-group btn-group-sm" role="group">
                                <input type="radio" class="btn-check" name="graphType" id="interventions" checked>
                                <label class="btn btn-outline-secondary" for="interventions">Interventions</label>
                                <input type="radio" class="btn-check" name="graphType" id="costs">
                                <label class="btn btn-outline-secondary" for="costs">Coûts</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div style="height: 300px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; border: 2px dashed #dee2e6;">
                        <div class="text-center">
                            <span class="fas fa-chart-bar fa-2x text-muted mb-2 d-block"></span>
                            <p class="text-muted mb-0">Évolution interventions et coûts</p>
                            <small class="text-muted">Oct 2024 - Sept 2025</small>
                        </div>
                    </div>
                    <!-- Légende graphique -->
                    <div class="row mt-3 text-center">
                        <div class="col-3">
                            <div class="fs-11"><span class="fas fa-square text-danger me-1"></span>Urgentes</div>
                            <div class="fs-10 fw-semi-bold">3 - €890</div>
                        </div>
                        <div class="col-3">
                            <div class="fs-11"><span class="fas fa-square text-warning me-1"></span>Planifiées</div>
                            <div class="fs-10 fw-semi-bold">6 - €1,200</div>
                        </div>
                        <div class="col-3">
                            <div class="fs-11"><span class="fas fa-square text-info me-1"></span>Préventives</div>
                            <div class="fs-10 fw-semi-bold">3 - €250</div>
                        </div>
                        <div class="col-3">
                            <div class="fs-11"><span class="fas fa-square text-success me-1"></span>Terminées</div>
                            <div class="fs-10 fw-semi-bold">28 - €2,340</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card h-100">
                <div class="card-header">
                    <h6 class="mb-0">Répartition par Type</h6>
                </div>
                <div class="card-body">
                    <div style="height: 200px; background: radial-gradient(circle, #f8f9fa 30%, #e9ecef 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto; width: 200px; border: 2px dashed #dee2e6;">
                        <div class="text-center">
                            <span class="fas fa-chart-pie fa-2x text-muted mb-2 d-block"></span>
                            <p class="text-muted mb-0 fs-11">Types interventions</p>
                        </div>
                    </div>
                    <!-- Détails types -->
                    <div class="mt-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <div class="fs-11"><span class="fas fa-wrench text-primary me-2"></span>Plomberie</div>
                            <div class="fs-11 fw-semi-bold">35% - €819</div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <div class="fs-11"><span class="fas fa-bolt text-warning me-2"></span>Électricité</div>
                            <div class="fs-11 fw-semi-bold">28% - €655</div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <div class="fs-11"><span class="fas fa-paint-roller text-info me-2"></span>Peinture</div>
                            <div class="fs-11 fw-semi-bold">22% - €515</div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <div class="fs-11"><span class="fas fa-tools text-secondary me-2"></span>Autres</div>
                            <div class="fs-11 fw-semi-bold">15% - €351</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Liste des demandes et suivi -->
    <div class="row g-3 mb-3">
        <div class="col-lg-8">
            <div class="card h-100">
                <div class="card-header">
                    <div class="row flex-between-end">
                        <div class="col-auto">
                            <h6 class="mb-0">Demandes de Maintenance Active</h6>
                        </div>
                        <div class="col-auto">
                            <div class="input-group input-group-sm">
                                <select class="form-select">
                                    <option>Toutes les priorités</option>
                                    <option>Urgente</option>
                                    <option>Normale</option>
                                    <option>Faible</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-sm table-hover mb-0">
                            <thead class="bg-light">
                            <tr>
                                <th class="border-0 fs-11">Demande</th>
                                <th class="border-0 fs-11">Bien</th>
                                <th class="border-0 fs-11">Type</th>
                                <th class="border-0 fs-11">Priorité</th>
                                <th class="border-0 fs-11">Prestataire</th>
                                <th class="border-0 fs-11">Coût Estimé</th>
                                <th class="border-0 fs-11">Statut</th>
                                <th class="border-0 fs-11">Actions</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="py-2">
                                    <strong>Fuite robinet cuisine</strong><br>
                                    <span class="fs-10 text-muted">Créée le 08/09/2025</span>
                                </td>
                                <td class="py-2">
                                    <strong>15 Rue Victor Hugo</strong><br>
                                    <span class="fs-10 text-muted">T3 - Marie Dubois</span>
                                </td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-primary">Plomberie</span>
                                </td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-danger rounded-pill">Urgente</span>
                                </td>
                                <td class="py-2">
                                    <strong>Plombier Dupont</strong><br>
                                    <span class="fs-10 text-muted">06.12.34.56.78</span>
                                </td>
                                <td class="py-2 fw-semi-bold">€180</td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-warning rounded-pill">En cours</span>
                                </td>
                                <td class="py-2">
                                    <div class="btn-group btn-group-sm">
                                        <button class="btn btn-outline-primary btn-sm" title="Voir détails">
                                            <span class="fas fa-eye"></span>
                                        </button>
                                        <button class="btn btn-outline-success btn-sm" title="Marquer terminé">
                                            <span class="fas fa-check"></span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-2">
                                    <strong>Peinture salon</strong><br>
                                    <span class="fs-10 text-muted">Créée le 05/09/2025</span>
                                </td>
                                <td class="py-2">
                                    <strong>22 Boulevard Jean Jaurès</strong><br>
                                    <span class="fs-10 text-muted">Studio - Vacant</span>
                                </td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-info">Peinture</span>
                                </td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-warning rounded-pill">Normale</span>
                                </td>
                                <td class="py-2">
                                    <strong>Peinture Pro</strong><br>
                                    <span class="fs-10 text-muted">06.98.76.54.32</span>
                                </td>
                                <td class="py-2 fw-semi-bold">€450</td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-info rounded-pill">Planifiée</span>
                                </td>
                                <td class="py-2">
                                    <div class="btn-group btn-group-sm">
                                        <button class="btn btn-outline-primary btn-sm" title="Voir détails">
                                            <span class="fas fa-eye"></span>
                                        </button>
                                        <button class="btn btn-outline-warning btn-sm" title="Modifier">
                                            <span class="fas fa-edit"></span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-2">
                                    <strong>Changement serrure</strong><br>
                                    <span class="fs-10 text-muted">Créée le 03/09/2025</span>
                                </td>
                                <td class="py-2">
                                    <strong>8 Avenue de la République</strong><br>
                                    <span class="fs-10 text-muted">T2 - Pierre Martin</span>
                                </td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-secondary">Serrurerie</span>
                                </td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-danger rounded-pill">Urgente</span>
                                </td>
                                <td class="py-2">
                                    <strong>Serrurier Express</strong><br>
                                    <span class="fs-10 text-muted">06.45.67.89.12</span>
                                </td>
                                <td class="py-2 fw-semi-bold">€120</td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-warning rounded-pill">En cours</span>
                                </td>
                                <td class="py-2">
                                    <div class="btn-group btn-group-sm">
                                        <button class="btn btn-outline-primary btn-sm" title="Voir détails">
                                            <span class="fas fa-eye"></span>
                                        </button>
                                        <button class="btn btn-outline-success btn-sm" title="Marquer terminé">
                                            <span class="fas fa-check"></span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="py-2">
                                    <strong>Révision chaudière</strong><br>
                                    <span class="fs-10 text-muted">Créée le 01/09/2025</span>
                                </td>
                                <td class="py-2">
                                    <strong>12 Place du Marché</strong><br>
                                    <span class="fs-10 text-muted">Maison - Fam. Rousseau</span>
                                </td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-success">Chauffage</span>
                                </td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-success rounded-pill">Préventive</span>
                                </td>
                                <td class="py-2">
                                    <strong>Chauffagiste Central</strong><br>
                                    <span class="fs-10 text-muted">06.11.22.33.44</span>
                                </td>
                                <td class="py-2 fw-semi-bold">€85</td>
                                <td class="py-2">
                                    <span class="badge badge-subtle-info rounded-pill">Planifiée</span>
                                </td>
                                <td class="py-2">
                                    <div class="btn-group btn-group-sm">
                                        <button class="btn btn-outline-primary btn-sm" title="Voir détails">
                                            <span class="fas fa-eye"></span>
                                        </button>
                                        <button class="btn btn-outline-info btn-sm" title="Calendrier">
                                            <span class="fas fa-calendar"></span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card-footer bg-light py-2">
                    <div class="row align-items-center">
                        <div class="col">
                            <span class="fs-11 text-muted">Affichage 4 demandes sur 12</span>
                        </div>
                        <div class="col-auto">
                            <nav aria-label="Pagination">
                                <ul class="pagination pagination-sm mb-0">
                                    <li class="page-item disabled"><a class="page-link" href="#">‹</a></li>
                                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                                    <li class="page-item"><a class="page-link" href="#">›</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card h-100">
                <div class="card-header">
                    <h6 class="mb-0">Suivi & Performance</h6>
                </div>
                <div class="card-body">
                    <!-- Satisfaction locataires -->
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <span class="fs-11">Satisfaction Locataires</span>
                            <span class="fs-11 fw-semi-bold text-success">4.3/5</span>
                        </div>
                        <div class="progress" style="height: 6px">
                            <div class="progress-bar bg-success" style="width: 86%"></div>
                        </div>
                    </div>

                    <!-- Budget maintenance -->
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <span class="fs-11">Budget Mensuel</span>
                            <span class="fs-11 fw-semi-bold text-warning">€2,340 / €3,000</span>
                        </div>
                        <div class="progress" style="height: 6px">
                            <div class="progress-bar bg-warning" style="width: 78%"></div>
                        </div>
                    </div>

                    <!-- Délai moyen résolution -->
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-1">
                            <span class="fs-11">Objectif Délai (≤ 5j)</span>
                            <span class="fs-11 fw-semi-bold text-success">3.2j</span>
                        </div>
                        <div class="progress" style="height: 6px">
                            <div class="progress-bar bg-success" style="width: 64%"></div>
                        </div>
                    </div>

                    <hr class="my-3">

                    <!-- Statistiques prestataires -->
                    <div class="row text-center">
                        <div class="col-6 border-end">
                            <div class="fs-4 fw-normal text-primary mb-1">8</div>
                            <div class="fs-11 text-muted">Prestataires Actifs</div>
                        </div>
                        <div class="col-6">
                            <div class="fs-4 fw-normal text-info mb-1">5</div>
                            <div class="fs-11 text-muted">Maintenance Préventive</div>
                        </div>
                    </div>

                    <hr class="my-3">

                    <!-- Actions rapides -->
                    <div class="d-grid gap-2">
                        <a class="btn btn-outline-primary btn-sm" href="maintenance/demandes.html">
                            <span class="fas fa-list me-1"></span>Toutes les Demandes
                        </a>
                        <a class="btn btn-outline-success btn-sm" href="maintenance/prestataires.html">
                            <span class="fas fa-user-tie me-1"></span>Prestataires
                        </a>
                        <a class="btn btn-outline-info btn-sm" href="maintenance/planning.html">
                            <span class="fas fa-calendar-alt me-1"></span>Planning
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alertes et planning -->
    <div class="row g-3">
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0">Alertes Maintenance</h6>
                </div>
                <div class="card-body">
                    <div class="alert alert-danger d-flex align-items-center" role="alert">
                        <span class="fas fa-exclamation-triangle me-2"></span>
                        <div class="flex-1">
                            <strong>3 demandes urgentes</strong> en attente
                            <div class="fs-11 text-muted">Intervention requise sous 24h</div>
                        </div>
                    </div>
                    <div class="alert alert-warning d-flex align-items-center" role="alert">
                        <span class="fas fa-calendar-times me-2"></span>
                        <div class="flex-1">
                            <strong>Budget mensuel à 78%</strong>
                            <div class="fs-11 text-muted">Reste €660 pour ce mois</div>
                        </div>
                    </div>
                    <div class="alert alert-info d-flex align-items-center" role="alert">
                        <span class="fas fa-clock me-2"></span>
                        <div class="flex-1">
                            <strong>5 maintenances préventives</strong> à programmer
                            <div class="fs-11 text-muted">Révisions annuelles obligatoires</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0">Planning Cette Semaine</h6>
                </div>
                <div class="card-body">
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-item-marker">
                                <span class="fas fa-tools text-warning"></span>
                            </div>
                            <div class="timeline-item-content">
                                <div class="d-flex justify-content-between">
                                    <strong>Peinture salon</strong>
                                    <small class="text-muted">Aujourd'hui 14h</small>
                                </div>
                                <div class="fs-11 text-muted">22 Bd Jean Jaurès - Peinture Pro</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-item-marker">
                                <span class="fas fa-fire text-success"></span>
                            </div>
                            <div class="timeline-item-content">
                                <div class="d-flex justify-content-between">
                                    <strong>Révision chaudière</strong>
                                    <small class="text-muted">Demain 10h</small>
                                </div>
                                <div class="fs-11 text-muted">12 Place du Marché - Chauffagiste</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-item-marker">
                                <span class="fas fa-bolt text-warning"></span>
                            </div>
                            <div class="timeline-item-content">
                                <div class="d-flex justify-content-between">
                                    <strong>Réparation électrique</strong>
                                    <small class="text-muted">Vendredi 9h</small>
                                </div>
                                <div class="fs-11 text-muted">5 Rue Pasteur - Électricien Martin</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
